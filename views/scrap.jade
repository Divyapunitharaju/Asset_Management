doctype html
html
  head
    meta(charset="UTF-8")
    meta(name="viewport", content="width=device-width, initial-scale=1.0")
    title Scrap Asset
    link(rel='stylesheet', href='https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css')
    link(rel="stylesheet", href="https://cdn.datatables.net/1.13.1/css/jquery.dataTables.min.css")
    link(rel="stylesheet", href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css")
    style.
      .centered-form {
        width: 50%;
        margin: 0 auto;
        margin-top: 10%;
        padding: 20px;
        border: 1px solid #ddd;
        border-radius: 10px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
      }
  body
    .container
      .centered-form
        h1.my-4.text-center Scrap Asset
        form#formasset(method="POST")
          .mb-3
            label(for="assetId", class="form-label") Select Asset:
            select(id="assetId" name="assetId" class="form-select" required)
              each asset in assets
                option(value=asset.id) #{asset.name}
          .mb-3
            label(for="scrapReason", class="form-label") Scrap Reason:
            textarea(id="scrapReason" name="scrapReason" class="form-control" rows="4" required)
          .d-flex.justify-content-center
            button#submitBtn(type="submit" class="btn btn-danger") Scrap Asset
          .d-flex.justify-content-center
            div#success.text-success.my-3
            div#danger.text-danger.my-3

    script.
      const form = document.getElementById('formasset');
      const submitBtn = document.getElementById('submitBtn');

      form.addEventListener('submit', async (e) => {
        e.preventDefault();
        const assetId = document.getElementById('assetId').value;
        const scrapReason = document.getElementById('scrapReason').value;

        const scrapData = { assetId, scrapReason };

        try {
          const response = await fetch('http://localhost:3000/scrap/', {
            method: "POST",
            headers: {
              "Content-Type": "application/json"
            },
            body: JSON.stringify(scrapData)
          });

          if (response.ok) {
            const result = await response.json();
            console.log(result);
            document.getElementById('success').textContent = result.message
            form.reset();
          } else {
            const error = await response.json();
            document.getElementById('danger')=error.message
          }
        } catch (err) {
          console.error(err);
          alert("An unexpected error occurred. Please try again.");
        }
      })
